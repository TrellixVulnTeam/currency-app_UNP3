{"version":3,"file":"ngx-indexed-db.js","sources":["../../../projects/ngx-indexed-db/src/lib/ngx-indexed-db.ts","../../../projects/ngx-indexed-db/src/utils/index.ts","../../../projects/ngx-indexed-db/src/lib/ngx-indexed-db.meta.ts","../../../projects/ngx-indexed-db/src/lib/ngx-indexed-db.service.ts","../../../projects/ngx-indexed-db/src/lib/ngxindexeddb.module.ts","../../../projects/ngx-indexed-db/src/ngx-indexed-db.ts"],"names":[],"mappings":"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","sourcesContent":["import { ObjectStoreMeta, ObjectStoreSchema } from './ngx-indexed-db.meta';\n\nexport function openDatabase(\n  indexedDB: IDBFactory,\n  dbName: string,\n  version: number,\n  upgradeCallback?: (a: Event, b: IDBDatabase) => void\n): Promise<IDBDatabase> {\n  return new Promise<IDBDatabase>((resolve, reject) => {\n    if (!indexedDB) {\n      reject('IndexedDB not available');\n    }\n    const request = indexedDB.open(dbName, version);\n    let db: IDBDatabase;\n    request.onsuccess = (event: Event) => {\n      db = request.result;\n      resolve(db);\n    };\n    request.onerror = (event: Event) => {\n      reject(`IndexedDB error: ${request.error}`);\n    };\n    if (typeof upgradeCallback === 'function') {\n      request.onupgradeneeded = (event: Event) => {\n        upgradeCallback(event, db);\n      };\n    }\n  });\n}\n\nexport function CreateObjectStore(\n  indexedDB: IDBFactory,\n  dbName: string,\n  version: number,\n  storeSchemas: ObjectStoreMeta[],\n  migrationFactory?: () => { [key: number]: (db: IDBDatabase, transaction: IDBTransaction) => void }\n): void {\n  if (!indexedDB) {\n    return;\n  }\n  const request: IDBOpenDBRequest = indexedDB.open(dbName, version);\n\n  request.onupgradeneeded = (event: IDBVersionChangeEvent) => {\n    const database: IDBDatabase = (event.target as any).result;\n\n    storeSchemas.forEach((storeSchema: ObjectStoreMeta) => {\n      if (!database.objectStoreNames.contains(storeSchema.store)) {\n        const objectStore = database.createObjectStore(storeSchema.store, storeSchema.storeConfig);\n        storeSchema.storeSchema.forEach((schema: ObjectStoreSchema) => {\n          objectStore.createIndex(schema.name, schema.keypath, schema.options);\n        });\n      }\n    });\n\n    const storeMigrations = migrationFactory && migrationFactory();\n    if (storeMigrations) {\n      Object.keys(storeMigrations)\n        .map((k) => parseInt(k, 10))\n        .filter((v) => v > event.oldVersion)\n        .sort((a, b) => a - b)\n        .forEach((v) => {\n          storeMigrations[v](database, request.transaction);\n        });\n    }\n\n    database.close();\n  };\n\n  request.onsuccess = (e: any) => {\n    e.target.result.close();\n  };\n}\n","export interface Options {\n  storeName: string;\n  dbMode: IDBTransactionMode;\n  error: (e: Event) => any;\n  complete: (e: Event) => any;\n  abort?: any;\n}\n\nexport function validateStoreName(db: IDBDatabase, storeName: string): boolean {\n  return db.objectStoreNames.contains(storeName);\n}\n\nexport function validateBeforeTransaction(db: IDBDatabase, storeName: string, reject: (message: string) => void): void {\n  if (!db) {\n    reject('You need to use the openDatabase function to create a database before you query it!');\n  }\n  if (!validateStoreName(db, storeName)) {\n    reject(`objectStore does not exists: ${storeName}`);\n  }\n}\n\nexport function createTransaction(db: IDBDatabase, options: Options): IDBTransaction {\n  const trans: IDBTransaction = db.transaction(options.storeName, options.dbMode);\n  trans.onerror = options.error;\n  trans.oncomplete = options.complete;\n  trans.onabort = options.abort;\n  return trans;\n}\n\nexport function optionsGenerator(type: any, storeName: any, reject: (reason?: any) => void, resolve: () => void): Options {\n  return {\n    storeName,\n    dbMode: type,\n    error: (e: Event) => {\n      reject(e);\n    },\n    complete: (e: Event) => {\n      resolve();\n    },\n    abort: (e: Event) => {\n      reject(e);\n    }\n  };\n}\n","import { InjectionToken } from '@angular/core';\n\nexport interface DBConfig {\n  name: string;\n  version: number;\n  objectStoresMeta: ObjectStoreMeta[];\n  migrationFactory?: () => { [key: number]: (db: IDBDatabase, transaction: IDBTransaction) => void };\n}\n\nexport interface ObjectStoreMeta {\n  store: string;\n  storeConfig: { keyPath: string | string[]; autoIncrement: boolean; [key: string]: any };\n  storeSchema: ObjectStoreSchema[];\n}\n\nexport interface ObjectStoreSchema {\n  name: string;\n  keypath: string | string[];\n  options: { unique: boolean; [key: string]: any };\n}\n\nexport interface IndexDetails {\n  indexName: string;\n  order: string;\n}\n\nexport interface RequestEvent<T> extends Event {\n  target: RequestEventTarget<T>;\n}\n\nexport interface RequestEventTarget<T> extends EventTarget {\n  result: T | T[];\n}\n\nexport enum DBMode {\n  readonly = 'readonly',\n  readwrite = 'readwrite',\n}\n\nexport type Key = string | number | Date | ArrayBufferView | ArrayBuffer | IDBArrayKey | IDBKeyRange;\n\nexport const CONFIG_TOKEN = new InjectionToken<DBConfig>(null);\n","import { Injectable, Inject, PLATFORM_ID } from '@angular/core';\nimport { openDatabase, CreateObjectStore } from './ngx-indexed-db';\nimport { createTransaction, optionsGenerator, validateBeforeTransaction } from '../utils';\nimport { CONFIG_TOKEN, DBConfig, Key, RequestEvent, ObjectStoreMeta, DBMode } from './ngx-indexed-db.meta';\nimport { isPlatformBrowser } from '@angular/common';\nimport { Observable, Observer, from } from 'rxjs';\nimport { take } from 'rxjs/operators';\n\n@Injectable()\nexport class NgxIndexedDBService<T = any> {\n  private readonly isBrowser: boolean;\n  private indexedDB: IDBFactory;\n\n  constructor(@Inject(CONFIG_TOKEN) private dbConfig: DBConfig, @Inject(PLATFORM_ID) private platformId: any) {\n    if (!dbConfig.name) {\n      throw new Error('NgxIndexedDB: Please, provide the dbName in the configuration');\n    }\n    if (!dbConfig.version) {\n      throw new Error('NgxIndexedDB: Please, provide the db version in the configuration');\n    }\n    this.isBrowser = isPlatformBrowser(this.platformId);\n    if (this.isBrowser) {\n      this.indexedDB =\n        window.indexedDB ||\n        (window as any).mozIndexedDB ||\n        (window as any).webkitIndexedDB ||\n        (window as any).msIndexedDB;\n      CreateObjectStore(\n        this.indexedDB,\n        dbConfig.name,\n        dbConfig.version,\n        dbConfig.objectStoresMeta,\n        dbConfig.migrationFactory\n      );\n    }\n  }\n\n  /**\n   * Allows to crate a new object store ad-hoc\n   * @param storeName The name of the store to be created\n   * @param migrationFactory The migration factory if exists\n   */\n  createObjectStore(\n    storeSchema: ObjectStoreMeta,\n    migrationFactory?: () => { [key: number]: (db: IDBDatabase, transaction: IDBTransaction) => void }\n  ): void {\n    const storeSchemas: ObjectStoreMeta[] = [storeSchema];\n    CreateObjectStore(this.indexedDB, this.dbConfig.name, ++this.dbConfig.version, storeSchemas, migrationFactory);\n  }\n\n  /**\n   * Adds new entry in the store and returns its key\n   * @param storeName The name of the store to add the item\n   * @param value The entry to be added\n   * @param key The optional key for the entry\n   */\n  add(storeName: string, value: T, key?: any): Observable<number> {\n    return from(\n      new Promise<number>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db: IDBDatabase) => {\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readwrite, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            const request: IDBRequest<IDBValidKey> = Boolean(key)\n              ? objectStore.add(value, key)\n              : objectStore.add(value);\n\n            request.onsuccess = (evt: Event) => {\n              const result = (evt.target as IDBOpenDBRequest).result;\n              resolve((result as unknown) as number);\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Returns entry by key.\n   * @param storeName The name of the store to query\n   * @param key The entry key\n   */\n  getByKey(storeName: string, key: IDBValidKey): Observable<T> {\n    return from(\n      new Promise<T>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db: IDBDatabase) => {\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readonly, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            const request = objectStore.get(key) as IDBRequest<T>;\n            request.onsuccess = (event: Event) => {\n              resolve((event.target as IDBRequest<T>).result);\n            };\n            request.onerror = (event: Event) => {\n              reject(event);\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Returns entry by id.\n   * @param storeName The name of the store to query\n   * @param id The entry id\n   */\n  getByID(storeName: string, id: string | number): Observable<T> {\n    return from(\n      new Promise<T>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db: IDBDatabase) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readonly, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            const request: IDBRequest = objectStore.get(id) as IDBRequest<T>;\n            request.onsuccess = (event: Event) => {\n              resolve((event.target as IDBRequest<T>).result);\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Returns entry by index.\n   * @param storeName The name of the store to query\n   * @param indexName The index name to filter\n   * @param key The entry key.\n   */\n  getByIndex(storeName: string, indexName: string, key: IDBValidKey): Observable<T> {\n    return from(\n      new Promise<T>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readonly, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            const index = objectStore.index(indexName);\n            const request = index.get(key) as IDBRequest<T>;\n            request.onsuccess = (event: Event) => {\n              resolve((event.target as IDBRequest<T>).result);\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Return all elements from one store\n   * @param storeName The name of the store to select the items\n   */\n  getAll(storeName: string): Observable<T[]> {\n    return from(\n      new Promise<T[]>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readonly, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n\n            const request: IDBRequest = objectStore.getAll();\n\n            request.onerror = (evt: Event) => {\n              reject(evt);\n            };\n\n            request.onsuccess = ({ target: { result: ResultAll } }: RequestEvent<T>) => {\n              resolve(ResultAll as T[]);\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Returns all items from the store after update.\n   * @param storeName The name of the store to update\n   * @param value The new value for the entry\n   * @param key The key of the entry to update if exists\n   */\n  update(storeName: string, value: T, key?: any): Observable<T[]> {\n    return from(\n      new Promise<T[]>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readwrite, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n\n            transaction.oncomplete = () => {\n              this.getAll(storeName)\n                .pipe(take(1))\n                .subscribe((newValues) => {\n                  resolve(newValues);\n                });\n            };\n\n            key ? objectStore.put(value, key) : objectStore.put(value);\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Returns all items from the store after delete.\n   * @param storeName The name of the store to have the entry deleted\n   * @param key The key of the entry to be deleted\n   */\n  delete(storeName: string, key: Key): Observable<T[]> {\n    return from(\n      new Promise<T[]>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readwrite, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            objectStore.delete(key);\n\n            transaction.oncomplete = () => {\n              this.getAll(storeName)\n                .pipe(take(1))\n                .subscribe((newValues) => {\n                  resolve(newValues);\n                });\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Returns true if successfully delete all entries from the store.\n   * @param storeName The name of the store to have the entries deleted\n   */\n  clear(storeName: string): Observable<boolean> {\n    return from(\n      new Promise<boolean>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readwrite, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            objectStore.clear();\n            transaction.oncomplete = () => {\n              resolve(true);\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Returns true if successfully delete the DB.\n   */\n  deleteDatabase(): Observable<boolean> {\n    return from(\n      new Promise<boolean>(async (resolve, reject) => {\n        try {\n          const db = await openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version);\n          await db.close();\n          const deleteDBRequest = this.indexedDB.deleteDatabase(this.dbConfig.name);\n          deleteDBRequest.onsuccess = () => {\n            resolve(true);\n          };\n          deleteDBRequest.onerror = reject;\n          deleteDBRequest.onblocked = () => {\n            throw new Error(`Unable to delete database because it's blocked`);\n          };\n        } catch (evt) {\n          reject(evt);\n        }\n      })\n    );\n  }\n\n  /**\n   * Returns the open cursor event\n   * @param storeName The name of the store to have the entries deleted\n   * @param keyRange The key range which the cursor should be open on\n   */\n  openCursor(storeName: string, keyRange?: IDBKeyRange): Observable<Event> {\n    return from(\n      new Promise<Event>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readonly, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            const request = keyRange === undefined ? objectStore.openCursor() : objectStore.openCursor(keyRange);\n\n            request.onsuccess = (event: Event) => {\n              resolve(event);\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Open a cursor by index filter.\n   * @param storeName The name of the store to query.\n   * @param indexName The index name to filter.\n   * @param keyRange The range value and criteria to apply on the index.\n   */\n  openCursorByIndex(\n    storeName: string,\n    indexName: string,\n    keyRange: IDBKeyRange,\n    mode: DBMode = DBMode.readonly\n  ): Observable<Event> {\n    return from(\n      new Promise<Event>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(mode, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            const index = objectStore.index(indexName);\n            const request = index.openCursor(keyRange);\n\n            request.onsuccess = (event: Event) => {\n              resolve(event);\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Returns all items by an index.\n   * @param storeName The name of the store to query\n   * @param indexName The index name to filter\n   * @param keyRange  The range value and criteria to apply on the index.\n   */\n  getAllByIndex(storeName: string, indexName: string, keyRange: IDBKeyRange): Observable<T[]> {\n    const data: T[] = [];\n    return from(\n      new Promise<T[]>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readonly, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            const index = objectStore.index(indexName);\n            const request = index.openCursor(keyRange);\n            request.onsuccess = (event) => {\n              const cursor: IDBCursorWithValue = (event.target as IDBRequest<IDBCursorWithValue>).result;\n              if (cursor) {\n                data.push(cursor.value);\n                cursor.continue();\n              } else {\n                resolve(data);\n              }\n            };\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n\n  /**\n   * Returns the number of rows in a store.\n   * @param storeName The name of the store to query\n   * @param keyRange  The range value and criteria to apply.\n   */\n  count(storeName: string, keyRange?: IDBValidKey | IDBKeyRange): Observable<number> {\n    return from(\n      new Promise<number>((resolve, reject) => {\n        openDatabase(this.indexedDB, this.dbConfig.name, this.dbConfig.version)\n          .then((db) => {\n            validateBeforeTransaction(db, storeName, reject);\n            const transaction = createTransaction(db, optionsGenerator(DBMode.readonly, storeName, reject, resolve));\n            const objectStore = transaction.objectStore(storeName);\n            const request: IDBRequest = objectStore.count(keyRange);\n            request.onerror = (e) => reject(e);\n            request.onsuccess = (e) => resolve(((e.target as IDBOpenDBRequest).result as unknown) as number);\n          })\n          .catch((reason) => reject(reason));\n      })\n    );\n  }\n}\n","import { NgModule, ModuleWithProviders, InjectionToken } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NgxIndexedDBService } from './ngx-indexed-db.service';\nimport { DBConfig, CONFIG_TOKEN } from './ngx-indexed-db.meta';\n\n@NgModule({\n  declarations: [],\n  imports: [CommonModule]\n})\nexport class NgxIndexedDBModule {\n  static forRoot(dbConfig: DBConfig): ModuleWithProviders<NgxIndexedDBModule> {\n    return {\n      ngModule: NgxIndexedDBModule,\n      providers: [NgxIndexedDBService, { provide: CONFIG_TOKEN, useValue: dbConfig }]\n    };\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"]}